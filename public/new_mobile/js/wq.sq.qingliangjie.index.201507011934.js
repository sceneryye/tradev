define('wq.sq.qingliangjie.index',function(require,exports,module){var __cacheThisModule__;var $=require('zepto');wfdata=require('wfdata'),fj=require('formatJson'),lazyLoad=require('lazyLoad'),qqRemind=require('qqRemind'),url=require('url'),login=require('login'),loadJS=require('loadJs'),cookie=require('cookie'),ui=require('ui'),scrollFlag=true,stick=require("sticky"),tabIndex=0,pretimeFormate={year:'0000',month:'00',day:'00',hour:'00'},pretime=url.getUrlParam("pretime"),moreBaokuanCount=[10,5,5,5,10,6];function pretimeDeal(){var len=pretime.length,pretimeOfThis=pretime;if(len==8){pretimeFormate.year=pretimeOfThis.substr(0,4);pretimeFormate.month=pretimeOfThis.substr(4,2);pretimeFormate.day=pretimeOfThis.substr(6,2);}
if(len==10){pretimeFormate.year=pretimeOfThis.substr(0,4);pretimeFormate.month=pretimeOfThis.substr(4,2);pretimeFormate.day=pretimeOfThis.substr(6,2);pretimeFormate.hour=pretimeOfThis.substr(8,2);}}
Date.prototype.formats=function(format){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S":this.getMilliseconds()}
if(/(y+)/.test(format))format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)
if(new RegExp("("+k+")").test(format))
format=format.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return format;}
$(window).bind('scroll',scrollWatch);function scrollWatch(){var firstHeight=Math.round($("#divSubjectRegion").offset().top),secondHeight=Math.round($("#divBaoKuan").offset().top),thirdHeight=Math.round($("#brandDiscountRegin").offset().top);curScrollHeight=$(window).scrollTop();if(curScrollHeight>0&&curScrollHeight<secondHeight){$(".menu a ").removeClass("active");$(".menu a").eq(0).addClass("active");}else if(curScrollHeight>secondHeight&&curScrollHeight<thirdHeight){$(".menu a ").removeClass("active");$(".menu a").eq(1).addClass("active");}else if(curScrollHeight>thirdHeight){$(".menu a ").removeClass("active");$(".menu a").eq(2).addClass("active");}}
function initClickTab(){$(".menu .option").bind("click",function(e){tabIndex=$(e.target).index();$(e.target).siblings().removeClass("active");$(e.target).addClass("active");sessionStorage.setItem("tabindex",tabIndex);});}
$(".coupon").bind("click",function(){var _activeName='jdqlj_mc';if(JD.device.scene==="weixin"){loadJS.loadScript("http://wq.jd.com/active/active_draw?ext=hj:w&active="+_activeName+"&callback=ActiveLotteryCallBack&t="+Math.random());}else{loadJS.loadScript("http://wq.jd.com/active/active_draw?ext=hj:q&active="+_activeName+"&callback=ActiveLotteryCallBack&t="+Math.random());}
window.ActiveLotteryCallBack=function(json){var jsom=json;if(json.ret==2){login.login();return;}
if((json.ret==11||json.ret==5||json.ret==7)){ui.info({msg:"不好意思，券已经领完！",icon:"none",delay:2000});}
if(json.ret==3||json.ret==4||json.ret==10){ui.info({msg:"您已经领过了券，赶快去使用哦！",icon:"none",delay:2000});}
if(json.ret==0){ui.info({msg:"恭喜您，领券成功！",icon:"none",delay:2000});}
if(json.ret==16){ui.info({msg:"您已经领过了券，赶快去使用哦！",icon:"none",delay:2000});}}});function initMostBaokuan(){var index=0,ppmsmoreBaokuan=moreBaokuan,length=ppmsmoreBaokuan.length,url="http://wq.jd.com/mcoss/mmart/mshow?pcs=",d=new Date().formats('MMddhh'),d=+d;if(pretime!=''){d=''+pretimeFormate.month+''+pretimeFormate.day+pretimeFormate.hour;d=+d;}
if(d>=62600&&d<70100){index=0;}else if(d>=70100&&d<70400){index=6;}else if(d>=70400&&d<70800){index=12;}else{index=0;}
var len=6+index-1;var len2=6+index;for(var i=index;i<len2;i++){var curBao=ppmsmoreBaokuan[i];if(i<len){url=url+curBao.goodID+":"+curBao.areaID+":"+curBao.jiaobiao+","}else{url=url+curBao.goodID+":"+curBao.areaID+":"+curBao.jiaobiao;}}
url=url+"&gbyarea=0&tpl=6&callback=callbckmostbao";url=url+(pretime?("&pretime="+new Date(pretimeFormate.year,parseInt(pretimeFormate.month)-1,pretimeFormate.day,pretimeFormate.hour).getTime()/1000):"");console.log(url);loadJS.loadScript({url:url,charset:"utf-8"});window.callbckmostbao=function(json){if(json.errCode!="0"){return;}
var morBaoDiv=$("#morebaokuan")[0];morBaoDiv.innerHTML=fj.formatJson('morebaokuanTpl',{data:json,ppmsinfo:louCengTitle,moreBaokuan:moreBaokuan,indexOfTitle:index});lazyLoad.autoLoadImage();scrollToClick();}}
function inintBrandDiscount(){var d=new Date().formats('MMddhh'),d=+d,index=0;if(pretime!=''){d=''+pretimeFormate.month+''+pretimeFormate.day+pretimeFormate.hour;d=+d;}
if(d>=62600&&d<70100){index=0;}else if(d>=70100&&d<70400){index=1;}else if(d>=70400&&d<70800){index=2;}else{index=0;}
url='http://wq.jd.com/mcoss/focusbi/show?gids='+bigBrands[index].areaID+'&pcs='+bigBrands[index].locationID+':'+bigBrands[index].showNumber+'&callback=brandDiscountBack';url=url+(pretime?("&pretime="+new Date(pretimeFormate.year,parseInt(pretimeFormate.month)-1,pretimeFormate.day,pretimeFormate.hour).getTime()/1000):"");console.log(url);loadJS.loadScript({url:url,charset:'utf-8'});window.brandDiscountBack=function(json){if(json.errCode!="0"){return;}
var list=json;var brandDiscount=$(".goodlist_brand")[0];brandDiscount.innerHTML=fj.formatJson('brandDiscountTpl',{data:list});scrollToClick();lazyLoad.autoLoadImage();}}
function InitSixGoogGe(){var sixGoogGeData=sixGonggeNew,brands=$(".brands")[0];brands.innerHTML=fj.formatJson('sixGoogGeTpl',{data:sixGoogGeData});scrollToClick();lazyLoad.autoLoadImage();}
function initMainTitle(){var mainTitlePpmsDate=mainTitle[0],mainTitleHTML="<a class='option active' href="+"javascript:$('#divSubjectRegion')[0].scrollIntoView();"+" ptag= "+mainTitlePpmsDate.ptagone+">"+mainTitlePpmsDate.mainone+"</a>"+"<a class='option ' href="+"javascript:$('#divBaoKuan')[0].scrollIntoView();"+" ptag= "+mainTitlePpmsDate.ptagtwo+">"+mainTitlePpmsDate.maintwo+"</a>"+"<a class='option ' href="+"javascript:$('#brandDiscountRegin')[0].scrollIntoView();"+" ptag= "+mainTitlePpmsDate.ptagthree+">"+mainTitlePpmsDate.mainthree+"</a>";$(".content .menu").html(mainTitleHTML);}
function initmoveTitle(){var d=new Date().formats('MMddhh'),d=+d,index=0;if(pretime!=''){d=''+pretimeFormate.month+''+pretimeFormate.day+pretimeFormate.hour;d=+d;}
if(d>=62600&&d<70100){index=0;}else if(d>=70100&&d<70400){index=1;}else if(d>=70400&&d<70800){index=2;}else{index=0;}
var moveTitleDate=moveTitle[index],moveTitleHTML="<span>"+moveTitle[index].titleone+"</span><span>"
+moveTitle[index].titletwo+"</span><span>"+moveTitle[index].titlethree+"</span>";$(".marquee .inner").html(moveTitleHTML);}
$(".home").bind("click",function(){history.replaceState('',document.title,location.href.replace(location.hash,"")+"#nowTop="+$(window).scrollTop());});function scrollToClick(){var nowTop=JD.url.getHash();if(nowTop==''){return;}
var nowArray=nowTop.split('=');var divHeight=$('.home').offset().height;if(nowArray.length>1){now=nowTop.split('=')[1];if(divHeight>now&&scrollFlag){window.scrollTo(0,now);scrollFlag=false;}else{return;}}else{return;}}
function hideQuan(){var d=new Date().formats('MMddhh'),d=+d;if(pretime!=''){d=''+pretimeFormate.month+''+pretimeFormate.day+pretimeFormate.hour;d=+d;}
if(d>=70100){$(".coupon").show();}}
function initTab(){var ti=sessionStorage.getItem('tabindex');if(ti==""){ti=0;}
$(".menu a ").removeClass("active");$(".menu a").eq(ti).addClass("active");}
function showSearch(){var caller=arguments.callee;try{$("#qoc").show();window._searchfoot.load();}catch(e){setTimeout(function(){caller();},100);}}
exports.doSomething=function(){pretimeDeal();initmoveTitle();initMainTitle();InitSixGoogGe();hideQuan();inintBrandDiscount();initMostBaokuan();initClickTab();initTab();scrollToClick();stick.init({domId:'mtab',direction:'up',fixClass:'fixedtop',useTransform:false,mouseWheel:true});if(JD.device.scene==="weixin"){$(".goodlist_brand img").css("top","5px").css("position","relative");$(".mod_foot_follow").css("margin-left","auto").css("width","95%").css("margin-right","auto");$(".mod_foot_follow a").css("text-decoration","none")}else{showSearch();$("#_ShowOfficalAccountBtn").attr("ptag","38087.12.1");}};});
